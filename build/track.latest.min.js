var Track=function(a){"use strict";var b=a._self=a._self||{};return a.version="Track version 0.0.4",a.developer=function(c){a._Utils.isUndefined(c)&&(c=!0),c?b.developer=!0:(b.developer=null,b.noSend=null)},a.init=function(c){b.config=c,a.destroy(),c.hasOwnProperty("developer")&&(delete c.developer,a.developer(),c.hasOwnProperty("noSend")&&(delete c.noSend,b.noSend=!0)),a._Core.Send.init(),a.page()},a.destroy=function(){a.developer(!1),b.internalCounter=0,b.page_sent=!1},a.toString=function(){return a.version},a}({});Track._Utils=function(a,b,c){"use strict";function d(){m.developer&&b&&b.log.apply(null,arguments)}function e(a,b){return b||(b="undefined"),typeof a===b}function f(a,b){b||(b=a,a={});var c,d,e;for(c in b)d=a[c],e=b[c],a!==e&&"undefined"!=typeof e&&null!==e&&(a[c]=e);return a}function g(a){try{return c.encodeURIComponent(a)}catch(b){return c.escape(a)}}function h(a){try{return c.decodeURIComponent(a)}catch(b){return c.unescape(a)}}function i(a){if(!a)return"";var b,c=2166136261;for(b=0;b<a.length;b++)c+=(c<<1)+(c<<4)+(c<<7)+(c<<8)+(c<<24),c^=a.charCodeAt(b);return Number(4294967295&c).toString(16)}function j(a){if(a!==Object(a))throw new TypeError("Object.keys called on a non-object");var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c}function k(a,b){var c,d=[];for(e(b)&&(b=[]),0===b.length&&(b=j(a)),c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&d.push(b[c]+"="+g(a[b[c]]));return d.join("&")}function l(a){var b,c,d={};for(a=a.split("&"),b=0;b<a.length;b+=1)c=a[b].split("="),d[c[0]]=c.slice(1).join("=");return d}var m=a._self=a._self||{};return{log:d,is:e,isUndefined:e,merge:f,encode:g,unencode:h,hash:i,objectKeys:j,serialize:k,unserialize:l}}(Track,console,window),Track._Core=function(a,b,c){"use strict";function d(a){return i.isUndefined(a)&&(a="t"+(new Date).valueOf()+"h"+b.history.length),j.clickID=a,a}function e(a){return i.isUndefined(a)&&(a=b.history.length+"."+1e3*Math.random()+"."+(new Date).getTime()+"."+i.hash(c.location.href+c.referrer)),a}function f(){return h.internalCounter=h.internalCounter+1,h.internalCounter}function g(b,c){i.isUndefined(c)&&(c=function(){});var d=i.merge(i.merge(j,h.config),i.merge(b,{callback:c}));d.requestID=e(),d.values=i.merge({c:"",t:d.clickID,u:d.requestID,o:f()},d.values),i.log(d),a._Core.Send.addAndRun(d)}var h=a._self=a._self||{},i=a._Utils,j={environment:"test",async:!0,callback:function(){}};return{clickID:d,track:g}}(Track,window,document),Track._Core.Send=function(a,b){"use strict";function c(a){u[a]=!0}function d(a){delete u[a]}function e(a){d(a);var b,c=o.all();for(b=0;b<c.length;b+=1)if(a===c[b].requestID){c.splice(b,1),o.replace(c).save();break}}function f(a){var b,c,d=1,e=0;for(b=0;b<a.length;b+=1)d+=a.charCodeAt(b),e+=d;return d%=65521,e%=65521,c=65536*e+d,c.toString(16)}function g(a){if(!a)return"";try{return b.btoa(q.unencode(q.encode(a)))}catch(c){var d,e,f,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=[];for(d=0;d<a.length;d+=3)e=a.length-d,f=0,f=a.charCodeAt(d)<<16&16711680,f|=e>1?a.charCodeAt(d+1)<<8&65280:0,f|=e>2?255&a.charCodeAt(d+2):0,h.push(g.charAt((16515072&f)>>18)),h.push(g.charAt((258048&f)>>12)),h.push(e>1?g.charAt((4032&f)>>6):"_"),h.push(e>2?g.charAt(63&f):"_");return h.join("")}}function h(a,b){a=a.split("");var c,d=[];for(c=0;c<a.length;c+=1)d.push(g(b[a[c]]));return d.join("*")+"*"}function i(a){return("production"===a?r:s)+t}function j(a,g){function j(){q.is(a.callback,"function")&&a.callback.call(a,n),n.status>=200&&n.status<300?(e(a.requestID),g()):d(a.requestID)}var k,l,m,n,o=(new Date).getTime()-a.queueTime;o>1e3&&26784e5>o&&(a.offlineLag=o,a.values.p+=(-1===a.values.p.indexOf("?")?"?":"&")+"offlineLag="+o),k="f="+a.format+"&d="+h(a.format,a.values),l="&c="+f(k);try{n=new b.XMLHttpRequest}catch(r){try{n=new b.ActiveXObject("Microsoft.XMLHttp")}catch(s){}}a.async&&(n.onreadystatechange=function(){4===n.readyState&&j()},n.onerror=j),c(a.requestID),m=[k,l].join(""),p.developer&&q.log(i(a.environment)+"?"+m),p.developer&&p.noSend||(n.open("POST",i(a.environment),a.async),n.send(m)),a.async||j()}function k(a){a.queueTime=(new Date).getTime(),o.add(a).save(),p.developer&&q.log("Store",o)}function l(){var a=o.first();a&&j(a,l)}function m(a){k(a),l()}function n(){o=new Track._Core.Store("requests"),b.addEventListener&&b.addEventListener("online",l),l()}var o,p=a._self=a._self||{},q=a._Utils,r="http://stats.ft.com",s="http://statstest.ft.com",t="/si/track.gif",u={};return{init:n,add:k,run:l,addAndRun:m}}(Track,window),Track._Core.Store=function(a,b){"use strict";if(Track._Utils.isUndefined(a))throw new Error("You must specify a name for the store.");this.config=Track._Utils.merge({storage:"best",expires:"10 years"},b),this.store=[];var c,d="o-tracking-module";return this.storageKey=[d,a].join("_"),this.storage=function(a,b){function c(a){a+="=";var c,d,e=b.document.cookie.split(";");for(c=0;c<e.length;c+=1)if(d=e[c].trim(),0===d.indexOf(a))return d.substring(a.length,d.length);return null}function e(a,c,d){var e,f,g="";Track._Utils.is(d,"number")&&(e=new Date,e.setTime(e.getTime()+24*d*60*60*1e3),g="expires="+e.toGMTString()+";"),f=Track._Utils.encode(a)+"="+Track._Utils.encode(c)+";"+g+"path=/;",b.document.cookie=f}function f(a){e(a,"",-1)}var g=d+"_InternalTest";if("cookie"!==a.storage)try{if(b.localStorage&&(b.localStorage.setItem(g,"TEST"),"TEST"===b.localStorage.getItem(g)))return b.localStorage.removeItem(g),{_type:"localStorage",load:function(a){return b.localStorage.getItem.call(b.localStorage,a)},save:function(a,c){return b.localStorage.setItem.call(b.localStorage,a,c)},remove:function(a){return b.localStorage.removeItem.call(b.localStorage,a)}}}catch(h){}return e(g,"TEST"),"TEST"===c(g)?(f(g),{_type:"cookie",load:c,save:e,remove:f}):{_type:"none",load:function(){},save:function(){},remove:function(){}}}(this.config,window),c=this.storage.load(this.storageKey),c&&(this.store=JSON.parse(c)),this},Track._Core.Store.prototype.all=function(){"use strict";if(0===this.store.length)return null;var a,b=[];for(a=0;a<this.store.length;a+=1)b.push(this.store[a].item);return b},Track._Core.Store.prototype.first=function(){"use strict";return 0===this.store.length?null:this.store[0].item},Track._Core.Store.prototype.last=function(){"use strict";return 0===this.store.length?null:this.store.slice(-1).item},Track._Core.Store.prototype.id=function(){"use strict";return 1e4*Math.random()+"."+(new Date).getTime()},Track._Core.Store.prototype.add=function(a){"use strict";function b(a){d.store.push({created_at:(new Date).valueOf(),id:d.id(),item:a})}var c,d=this;if(Track._Utils.is(a,"object")&&a.constructor.toString().match(/array/i))for(c=0;c<a.length;c+=1)b(a[c]);else b(a);return d},Track._Core.Store.prototype.replace=function(a){"use strict";if(Track._Utils.is(a,"object")&&a.constructor.toString().match(/array/i))return this.store=[],this.add(a).save(),this;throw new Error("Argument invalid, must be an array.")},Track._Core.Store.prototype.save=function(){"use strict";return this.storage.save(this.storageKey,JSON.stringify(this.store)),this},Track.page=function(a,b,c){"use strict";function d(a){if(g.isUndefined(a))throw new Error("URL must be specified");return-1===a.indexOf("://")&&("/"!==a.substring(0,1)&&(a="/"+a),a=c.location.protocol+"//"+c.location.hostname+a),-1===a.indexOf("?")?a+=b.location.search:a=a.substr(0,a.indexOf("?"))+"?"+g.serialize(g.merge(g.unserialize(b.location.search.substring(1)),g.unserialize(a.substr(a.indexOf("?")+1)))),a}var e="pcrtgyuo",f=a._self=a._self||{},g=a._Utils,h={url:c.URL,referrer:c.referrer,co:b.screen.colorDepth,sr:b.screen.width+"x"+b.screen.height,lt:(new Date).toISOString(),jv:b.navigator.javaEnabled()?"1":"0",async:!1};return function(b,c){b=g.merge(h,b),a._Core.clickID(),a._Core.track({async:b.async,format:e,values:{p:d(b.url),r:b.referrer,g:g.serialize(b,["co","sr","lt","jv"]),y:"page"}},c),f.page_sent=!0}}(Track,window,document);