!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports=function(){"use strict";function b(a){g.isUndefined(a)&&(a=!0),a?f.set("developer",!0):(f.set("developer",null),f.set("noSend",null))}function c(){b(!1),f.set("internalCounter",0),f.set("page_sent",!1)}function d(d){f.set("config",d),f.set("version",h),c(),d.hasOwnProperty("developer")&&(delete d.developer,b(),d.hasOwnProperty("noSend")&&(delete d.noSend,f.set("noSend",!0))),a("./src/javascript/core/user").init(d.userID),a("./src/javascript/core/session").init(d.session),a("./src/javascript/core/send").init(h)}function e(){return"oTracking version "+h}var f=a("./src/javascript/core/settings"),g=a("./src/javascript/utils"),h="0.0.18";return{init:d,developer:b,destroy:c,toString:e,page:a("./src/javascript/page"),event:a("./src/javascript/event"),link:a("./src/javascript/link")}}()},{"./src/javascript/core/send":4,"./src/javascript/core/session":5,"./src/javascript/core/settings":6,"./src/javascript/core/user":8,"./src/javascript/event":9,"./src/javascript/link":10,"./src/javascript/page":11,"./src/javascript/utils":12}],2:[function(a,b){b.exports=function(){"use strict";function b(a){return a=c(a),k.tag.rootID=a,a}function c(a){return j.isUndefined(a)&&(a=j.createUniqueID()),a}function d(){return i.set("internalCounter",i.get("internalCounter")+1),i.get("internalCounter")}function e(a,e){j.isUndefined(e)&&(e=function(){}),k.tag.rootID||b();var i=j.merge(j.merge(k),j.merge(a,{callback:e}));i=j.merge({id:c(),tag:{counter:d()},user:{sessionID:h.session(),userID:g.userID()},device:{userAgent:window.navigator.userAgent}},i),j.log("Core.Track",i),f.addAndRun(i)}var f=a("./core/send"),g=a("./core/user"),h=a("./core/session"),i=a("./core/settings"),j=a("./utils"),k={async:!0,callback:function(){},tag:{}};return{setRootID:b,getRootID:function(){return k.tag.rootID},track:e}}()},{"./core/send":4,"./core/session":5,"./core/settings":6,"./core/user":8,"./utils":12}],3:[function(a,b){b.exports=function(){"use strict";var b=a("../utils"),c=a("./store"),d=function(a){if(b.isUndefined(a))throw new Error("You must specify a name for the queue.");return this.queue=[],this.storage=new c(a),this.storage.read()&&(this.queue=this.storage.read()),this};return d.prototype.all=function(){if(0===this.queue.length)return null;var a,b=[];for(a=0;a<this.queue.length;a+=1)b.push(this.queue[a].item);return b},d.prototype.first=function(){return 0===this.queue.length?null:this.queue[0].item},d.prototype.last=function(){return 0===this.queue.length?null:this.queue.slice(-1)[0].item},d.prototype.id=function(){return 1e4*Math.random()+"."+(new Date).getTime()},d.prototype.add=function(a){function c(a){e.queue.push({created_at:(new Date).valueOf(),id:e.id(),item:a})}var d,e=this;if(b.is(a,"object")&&a.constructor.toString().match(/array/i))for(d=0;d<a.length;d+=1)c(a[d]);else c(a);return e},d.prototype.replace=function(a){if(b.is(a,"object")&&a.constructor.toString().match(/array/i))return this.queue=[],this.add(a).save(),this;throw new Error("Argument invalid, must be an array.")},d.prototype.shift=function(){var a,b=this.all(),c=this.first();if(!c)return null;for(a=0;a<b.length;a+=1)if(c.id===b[a].id){b.splice(a,1),this.replace(b).save();break}return c},d.prototype.save=function(){return this.storage.write(this.queue),this},d}()},{"../utils":12,"./store":7}],4:[function(a,b){b.exports=function(b){"use strict";function c(){try{var a=new b.XMLHttpRequest;if(!o.is(a.withCredentials))return{xmlHttp:a,XDomainRequest:!1};if(!o.is(b.XDomainRequest))return{xmlHttp:new b.XDomainRequest,XDomainRequest:!0}}catch(c){try{return{xmlHttp:new b.ActiveXObject("Microsoft.XMLHTTP"),XDomainRequest:!1}}catch(d){}}return null}function d(a){r[a]=!0}function e(a){delete r[a]}function f(a){e(a);var b,c=m.all();for(b=0;b<c.length;b+=1)if(a===c[b].id){c.splice(b,1),m.replace(c).save();break}}function g(a,b){function g(c){o.is(m,"function")&&(m.call(a,c),o.log("calling user_callback")),c.status>=200&&c.status<300?(f(a.id),b()):e(a.id)}var h,i,j=(new Date).getTime()-a.queueTime,k=c(),m=a.callback;k&&(a=o.merge({tag:{apiKey:"",version:l,id:a.id,counter:a.counter,offset:0}},a),j>1e3&&26784e5>j&&(a.tag.offset=j),i=k.xmlHttp,delete a.counter,delete a.callback,delete a.async,delete a.type,delete a.queueTime,o.log("user_callback",m),o.log("PreSend",a),d(a.id),h=JSON.stringify(a),o.log("path",h),k.XDomainRequest?i.onload=function(){g(i)}:i.onreadystatechange=function(){4===i.readyState&&g(i)},i.onerror=function(){g(i)},n.get("developer")&&n.get("noSend")||(i.open("POST",q,!0),k.XDomainRequest||i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(h)))}function h(a){a.queueTime=(new Date).getTime(),m.add(a).save(),o.log("AddedToQueue",m)}function i(a){o.isUndefined(a)&&(a=function(){});var b=function(){i(),a()},c=m.first();return c?r[c.id]?a():g(c,b):a()}function j(a){h(a),i()}function k(a){l=a,m=new p("requests"),n.get("config")&&n.get("config").server&&(q=n.get("config").server),o.addEvent(b,"online",i),i()}var l,m,n=a("./settings"),o=a("../utils"),p=a("./queue"),q="http://test.tracking.ft.com",r={};return{init:k,add:h,run:i,addAndRun:j}}(window)},{"../utils":12,"./queue":3,"./settings":6}],5:[function(a,b){var c;b.exports=function(){"use strict";function b(a){var b=new Date;b.setTime(b.getTime()+c.config.expires),c.write({value:a,expiry:b.valueOf()})}function d(){var a,d=c.read();if(d){var e=(new Date).valueOf(),f=parseInt(d.expiry);f>=e&&(a=d.value)}return a||(a=g.b64encode(g.createUniqueID())),b(a),a}function e(a){g.is(a,"string")&&(a={name:a}),g.is(a)&&(a={});var b=g.merge(f,a);return"cookie"===b.storage&&a.name&&(b.nameOverride=b.name),c=new h(b.name,b),d()}var f={storage:"best",name:"session",expires:18e5},g=a("../utils"),h=a("./store");return{init:e,session:d}}()},{"../utils":12,"./store":7}],6:[function(a,b){var c={internalCounter:0};b.exports=function(){"use strict";function a(a,b){c[a]=b}function b(a){return c[a]}function d(a){delete c[a]}return{set:a,get:b,"delete":d}}()},{}],7:[function(a,b){b.exports=function(){"use strict";var b=function(b,c){var d,e="o-tracking",f=a("../utils");if(f.isUndefined(b))throw new Error("You must specify a name for the store.");if(this.config=f.merge({storage:"best",expires:31536e7},c),this.data=null,this.storageKey=this.config.hasOwnProperty("nameOverride")?this.config.nameOverride:[e,b].join("_"),this.storage=function(a,b){function c(a){a+="=";var c,d,e=b.document.cookie.split(";");for(c=0;c<e.length;c+=1)if(d=e[c].replace(/^\s+|\s+$/g,""),0===d.indexOf(a))return d.substring(a.length,d.length);return null}function d(a,c,d){var e,g,h="";f.is(d,"number")&&(e=new Date,e.setTime(e.getTime()+d),h="expires="+e.toGMTString()+";"),g=f.encode(a)+"="+f.encode(c)+";"+h+"path=/;",b.document.cookie=g}function g(a){d(a,"",-1)}var h=e+"_InternalTest";if("cookie"!==a.storage)try{if(b.localStorage&&(b.localStorage.setItem(h,"TEST"),"TEST"===b.localStorage.getItem(h)))return b.localStorage.removeItem(h),{_type:"localStorage",load:function(a){return b.localStorage.getItem.call(b.localStorage,a)},save:function(a,c){return b.localStorage.setItem.call(b.localStorage,a,c)},remove:function(a){return b.localStorage.removeItem.call(b.localStorage,a)}}}catch(i){}return d(h,"TEST"),"TEST"===c(h)?(g(h),{_type:"cookie",load:c,save:d,remove:g}):{_type:"none",load:function(){},save:function(){},remove:function(){}}}(this.config,window),d=this.storage.load(this.storageKey))try{this.data=JSON.parse(d)}catch(g){this.data=d}return this};return b.prototype.read=function(){return this.data},b.prototype.write=function(a){return this.data=a,this.storage.save(this.storageKey,"string"==typeof this.data?this.data:JSON.stringify(this.data),this.config.expires),this},b.prototype.destroy=function(){return this.data=null,this.storage.remove(this.storageKey),this},b}()},{"../utils":12}],8:[function(a,b){var c;b.exports=function(){"use strict";function b(a){e.is(a,"string")&&(a={value:a});var b,g=e.merge(d,a);return"cookie"===g.storage&&a.name&&(g.nameOverride=g.name),b=new f(g.name,g),c=b.read(),c||(c=g.value),c||(c=e.b64encode(e.createUniqueID())),b.write(c),c}var d={storage:"best",name:"userID",value:null},e=a("../utils"),f=a("./store");return{init:b,userID:function(){return c}}}()},{"../utils":12,"./store":7}],9:[function(a,b){b.exports=function(b){"use strict";function c(a,b,c,g,h){var i=e.merge(e.merge(f),{event:{category:a,action:b,key:c,value:g}});d.track(i,h)}var d=a("./core"),e=a("./utils"),f={tag:{type:"event"},event:{}};return e.addEvent(b,"oTracking.event",function(a){c(a.category,a.action,a.key,a.value)}),c}(window)},{"./core":2,"./utils":12}],10:[function(a,b){b.exports=function(b){"use strict";function c(a){return a.indexOf(b.document.location.hostname)>-1}function d(a){return!c(a)}function e(a){var b=a.replace(/^\w+:\/\//,"").replace(/(#|\?).+/g,"").replace(/\/$/,"");return-1===b.indexOf("/")?!1:b.match(/\.(\w{2,4})$/)?["html","htm","php"].indexOf(RegExp.$1)>-1?!1:!0:!1}function f(a){if(!a)return[];var b=[a];return"BODY"===a.nodeName?b:b.concat(f(a.parentElement))}function g(a){var b=f(a),c=a.href;return c=c.replace(/^http:\/\/[\w\.]+/,"").replace(/^\//,"").replace(/(\?|#).*$/,"").replace(/\/$/,"").replace(/\.[a-z]{3,4}$/,""),""===c&&(c=a.href.replace(/^http:\/\//,"").split("?")[0].replace(/\/$/,"")),c=c.split("/").slice(-2).filter(function(a){return a}),c.slice(-1)[0].match(/[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}/)&&(c=c.slice(-1)),c=(c.length>1?c.slice(0,2).join("-"):c[0]).toLowerCase(),b.map(function(a){return a.tagName.toLowerCase()}).filter(function(a,b,c){return c.lastIndexOf(a)===b}).reverse().join("/")+"/"+c}function h(a){var b=g(a),f=p.merge(p.merge(q),{link:{destinationID:"",link:b,sourceID:o.getRootID()}});return d(a.href)||e(a.href)?(f.async=!1,o.track(f,r)):(c(a.href)&&m.add(f).save(),!0)}function i(a){return h(a.target)}function j(a){r=a}function k(){var a=function(){k(),r()},b=m.shift();b&&o.track(b,a)}function l(a){var c,d;if(m=new n("links"),k(),p.onPage(k),p.is(a)&&(a={}),a=p.merge({root:b.document,selector:"a",event:"click",links:null},a),a.hasOwnProperty("callback")&&(r=a.callback),a.links&&p.is(a.links,"object")&&a.links.constructor.toString().match(/array/i))for(c=a.links,d=0;d<c.length;d+=1)p.addEvent(c[d],a.event,i);else{if("object"!=typeof a.root||"string"!=typeof a.selector)throw"If supplying a config it must have a valid root element and a selector string";p.addEvent(a.root,a.event,function(b){b.target.tagName===a.selector.toUpperCase()&&i.call(b.target,b)})}}var m,n=a("./core/queue"),o=a("./core"),p=a("./utils"),q={tag:{type:"link"},link:{}},r=function(){};return p.addEvent(b,"oTracking.link",h),{init:l,onClick:j,track:h}}(window)},{"./core":2,"./core/queue":3,"./utils":12}],11:[function(a,b){b.exports=function(b,c){"use strict";function d(a){if(f.isUndefined(a))throw new Error("URL must be specified");return-1===a.indexOf("://")&&("/"!==a.substring(0,1)&&(a="/"+a),a=c.location.protocol+"//"+c.location.hostname+a),-1===a.indexOf("?")?a+=b.location.search:a=a.substr(0,a.indexOf("?"))+"?"+f.serialize(f.merge(f.unserialize(b.location.search.substring(1)),f.unserialize(a.substr(a.indexOf("?")+1)))),a}var e=a("./core"),f=a("./utils"),g={tag:{type:"page"},page:{url:c.URL,referrer:c.referrer},async:!0};return function(a,b){a=f.merge(f.merge(g),a),a.page.url=d(a.page.url),e.setRootID(),e.track(a,b),f.triggerPage()}}(window,document)},{"./core":2,"./utils":12}],12:[function(a,b){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=a("./core/settings"),e=[];b.exports=function(a){"use strict";function b(){d.get("developer")&&a.console&&a.console.log.apply(null,arguments)}function f(a,b){return b||(b="undefined"),typeof a===b}function g(a,b){b||(b=a,a={});var c,d,e;for(c in b)d=a[c],e=b[c],a!==e&&"undefined"!=typeof e&&null!==e&&""!==e&&(a[c]=d!==Object(d)||f(d,"function")?e:g(d,e));return a}function h(b){try{return a.encodeURIComponent(b)}catch(c){return a.escape(b)}}function i(b){try{return a.decodeURIComponent(b)}catch(c){return a.unescape(b)}}function j(b){if(!b)return"";if(b=h(b),a.btoa)return a.btoa(b);var d,e,f,g="";for(d=0;d<b.length;d+=3)e=b.length-d,f=0,f=b.charCodeAt(d)<<16&16711680,f|=e>1?b.charCodeAt(d+1)<<8&65280:0,f|=e>2?255&b.charCodeAt(d+2):0,g+=c.charAt((16515072&f)>>18),g+=c.charAt((258048&f)>>12),g+=e>1?c.charAt((4032&f)>>6):"_",g+=e>2?c.charAt(63&f):"_";return g}function k(a){if(!a)return"";var b,c=2166136261;for(b=0;b<a.length;b++)c+=(c<<1)+(c<<4)+(c<<7)+(c<<8)+(c<<24),c^=a.charCodeAt(b);return Number(4294967295&c).toString(16)}function l(a){if(a!==Object(a))throw new TypeError("Object.keys called on a non-object");if(Object.hasOwnProperty("keys"))return Object.keys(a);var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c}function m(a,b){var c,d=[];for(f(b)&&(b=[]),0===b.length&&(b=l(a)),c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&d.push(b[c]+"="+h(a[b[c]]));return d.join("&")}function n(a){var b,c,d={};for(a=a.split("&"),b=0;b<a.length;b+=1)c=a[b].split("="),d[c[0]]=c.slice(1).join("=");return d}function o(a){var b=String(a);return 1===b.length&&(b="0"+b),b}function p(a){return Date.prototype.hasOwnProperty("toISOString")?a.toISOString():[a.getUTCFullYear(),"-",o(a.getUTCMonth()+1),"-",o(a.getUTCDate()),"T",o(a.getUTCHours()),":",o(a.getUTCMinutes()),":",o(a.getUTCSeconds()),".",String((a.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5),"Z"].join("")}function q(){return a.history.length+"."+1e3*Math.random()+"."+(new Date).getTime()+"."+k(a.document.location.href+a.document.referrer)}function r(a,b,c){try{a.addEventListener(b,c,!1)}catch(d){try{a.attachEvent("on"+b,c)}catch(e){}}}function s(a){f(a,"function")&&e.push(a)}function t(){var a;for(a=0;a<e.length;a+=1)e[a]()}return{log:b,is:f,isUndefined:f,merge:g,encode:h,unencode:i,hash:k,objectKeys:l,serialize:m,unserialize:n,b64encode:j,toISOString:p,createUniqueID:q,addEvent:r,onPage:s,triggerPage:t}}(window)},{"./core/settings":6}]},{},[1]);